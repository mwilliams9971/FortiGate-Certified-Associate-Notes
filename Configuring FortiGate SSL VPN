# Lesson 11: Configuring FortiGate SSL VPN  
**Course:** FortiGate Certified Associate (FCA)  
**Duration:** 30 minutes  

---

## Learning Objectives
- Describe what SSL VPN is and its benefits  
- Explain how FortiGate SSL VPN works  
- Configure FortiGate SSL VPN  
- Apply general best practices when using SSL VPN  

---

## 1. What is SSL VPN and Its Benefits
A **Secure Socket Layer Virtual Private Network (SSL VPN)** uses SSL/TLS encryption to establish a secure, encrypted tunnel between a remote client and a FortiGate device acting as the VPN server.  

### Key Benefits
1. **Use of Common Protocols (HTTP/HTTPS)**  
   - SSL VPN traffic uses **TCP port 443**, which is almost always open through firewalls and proxies.  
   - This allows VPN access even from restrictive networks.  

2. **Flexible Client Access**  
   - Users can connect using only a **web browser** (Web Mode) or the **FortiClient VPN** software (Tunnel Mode).  
   - This flexibility is particularly useful for mobile devices and remote work scenarios.  

3. **Granular Resource Access**  
   - Administrators can precisely define which internal resources each user or group can access.  
   - Access can be limited to specific servers, IPs, or services.  

4. **Endpoint Compliance Checks (Windows)**  
   - FortiGate can verify that connecting Windows devices meet security standards (e.g., active antivirus, firewall enabled).  
   - Access can be denied if requirements are not met.  

5. **Cost-Effective Solution**  
   - No additional license is required for SSL VPN functionality.  
   - The **FortiClient VPN** software is free and can be made available for download from the SSL VPN portal.  
   - The number of concurrent users depends on the FortiGate model capacity.  

---

## 2. How FortiGate SSL VPN Works
FortiGate supports **two SSL VPN modes**, each suited to different use cases:

### a. Web Mode
- Provides access to web-based applications through a browser.  
- FortiGate acts as a **reverse web proxy**, translating internal resources into web-accessible content.  
- **Advantages:**
  - No client software required.  
  - Ideal for casual or temporary users.  
  - Supports URL access, FTP servers, bookmarks, and custom web applications.  
- **Limitations:**
  - Limited application and protocol support.  
  - Not suitable for full network access.  

### b. Tunnel Mode
- Provides **full network access** as if the remote client were physically on the internal network.  
- Requires the **FortiClient VPN** software installed and configured on the endpoint.  
- **Advantages:**
  - Supports all protocols and applications.  
  - Seamless access to internal networks.  
- **Limitations:**
  - Requires client installation and configuration.  
  - May create additional overhead for support and maintenance.  

---

## 3. Configuring FortiGate SSL VPN

### Step 1 – Create Users and Groups
- Navigate to *User & Authentication > User Definition* and create local users or integrate with external authentication servers (LDAP, RADIUS, or FortiAuthenticator).  
- Group users logically based on access level (e.g., “Remote_Users”).  

### Step 2 – Review or Create SSL VPN Portals
- Go to *VPN > SSL-VPN Portals.*  
- FortiGate includes default portals (e.g., *full-access*, *web-access*, *tunnel-access*).  
- Customize as needed:
  - Define connection mode (Web, Tunnel, or Both).  
  - Set bookmarks, host checks, and user interface preferences.  

### Step 3 – Configure SSL VPN Settings
- Navigate to *VPN > SSL-VPN Settings.*  
- Specify:
  - **Listening Interface:** typically the WAN interface.  
  - **Listening Port:** default is 443.  
  - **Server Certificate:** replace the default self-signed certificate with a trusted one.  
  - **Authentication/Portal Mapping:** associate user groups with the appropriate portal.  

### Step 4 – Create Firewall Policy for SSL VPN Traffic
- Add a policy allowing traffic from the SSL VPN interface to internal networks.  
- Apply least-privilege rules (limit access to necessary subnets).  
- Enable logging for visibility and auditing.  

### Step 5 – Verify and Monitor
- Connect using a browser (for Web Mode) or FortiClient (for Tunnel Mode).  
- Verify that access is successful and limited to intended resources.  
- Monitor active sessions in *Monitor > SSL-VPN Monitor*.  

---

## 4. Best Practices for SSL VPN Deployment

1. **Choose the Appropriate SSL VPN Mode**  
   - Enable only the required mode (Web or Tunnel) to reduce exposure.  
   - Disable unused portal modes.  

2. **Use Centralized Authentication**  
   - Integrate FortiGate with **RADIUS**, **LDAP**, or **FortiAuthenticator** instead of relying on local users.  
   - Simplifies management and enforces consistency across devices.  

3. **Replace the Default Certificate**  
   - Install a valid, trusted SSL certificate to prevent browser warnings and ensure user trust.  
   - You can purchase a certificate or use an internal PKI infrastructure.  

4. **Apply the Principle of Least Privilege**  
   - Restrict firewall policies to only the necessary resources.  
   - Avoid “any-to-any” policies for remote users.  

5. **Enable Endpoint Compliance Checks**  
   - Require connecting endpoints (especially Windows) to have antivirus, firewall, and updated OS patches.  

6. **Restrict Access by Source Location**  
   - Limit SSL VPN logins to specific public IP addresses or geolocations when feasible.  

7. **Keep FortiGate Firmware Updated**  
   - SSL VPN vulnerabilities are often targeted; keep firmware current and review Fortinet advisories.  

---

## 5. CLI and Monitoring Commands

```bash
# View SSL VPN configuration
show vpn ssl settings

# View active SSL VPN sessions
get vpn ssl monitor

# Debug SSL VPN connection issues
diagnose debug application sslvpn -1
diagnose debug enable
