# Lesson 09: Controlling Applications Access  
**Course:** FortiGate Certified Associate (FCA)  
**Duration:** 15 minutes  

---

## Learning Objectives
- Understand application control and its purpose  
- Explain how FortiGate application control limits and manages application traffic  
- Configure application control in FortiGate  
- Monitor and analyze application control activity  

---

## 1. Understanding Application Control
**Application Control** enhances network security and compliance by identifying and managing traffic generated by specific applications or actions within applications.  
It allows administrators to enforce policies that monitor, block, or prioritize application traffic—regardless of port, protocol, or encryption.

### Why It’s Important
- Detects and manages applications that use **dynamic ports** or **peer-to-peer (P2P)** architectures (e.g., BitTorrent, Skype).  
- Helps meet **compliance standards** and **acceptable use policies**.  
- Reduces network congestion by shaping bandwidth-heavy traffic.  
- Strengthens overall security by limiting risky or unapproved applications.  

### Application Control Actions
Once traffic is identified, FortiGate can take several actions:
- **Monitor:** Log application activity for reporting and visibility.  
- **Block:** Prevent access to or execution of an application.  
- **Quarantine:** Isolate devices using risky applications.  
- **Traffic Shaping:** Limit bandwidth for specific applications.  

---

## 2. How FortiGate Application Control Works
FortiGate uses **pattern-based detection** and **flow-based inspection** to recognize applications in network traffic.

### Key Concepts
- **Signature Matching:**  
  FortiGate compares traffic behavior and byte patterns against the **FortiGuard Application Control Database**, which contains thousands of application signatures maintained by FortiGuard Labs.  

- **Flow-Based Analysis (via IPS Engine):**  
  Traffic analysis is performed at the IPS (Intrusion Prevention System) layer using **flow-based inspection**.  
  This method scans the **entire byte stream** of packets—independent of protocol or port number.

- **Evasion Resistance:**  
  Many applications attempt to bypass firewall policies using port hopping or encryption.  
  Application control identifies these applications through characteristic **transmission patterns**, not static ports.  

### Application Control Profile
- Application Control is managed through **profiles**, which are applied to firewall policies.  
- Each profile organizes application signatures into **categories** such as:
  - **Collaboration**
  - **File Sharing**
  - **Social Media**
  - **Games**
  - **P2P**
- Each category (or individual signature) can be set to:
  - **Allow**  
  - **Block**  
  - **Monitor**  
  - **Quarantine**

### Signature Hierarchy and Overrides
- **Parent categories** define the default action for a group of applications.  
- **Child signatures** (specific applications) can override parent category actions.  
- The **Override** option allows fine-tuning of individual application behavior.  

---

## 3. Configuring FortiGate Application Control

### Configuration Steps
1. **Create or Edit an Application Control Profile**  
   - Navigate to *Security Profiles > Application Control.*  
   - Create a new profile or modify an existing one.  
   - Adjust category actions or create signature-level overrides.  

2. **Apply the Profile to a Firewall Policy**  
   - Go to *Policy & Objects > Firewall Policy.*  
   - Edit or create a policy for the traffic to inspect.  
   - Under *Security Profiles*, enable **Application Control** and select your profile.  

3. **Verify Configuration**  
   - Generate test traffic from applications (e.g., social media or P2P tools).  
   - Confirm that actions (block, monitor, shape) behave as configured.  

4. **Monitor and Log Activity**  
   - Go to *Log & Report > Application Control* to view detected and blocked applications.  
   - Use *FortiView > Applications* for visual traffic breakdowns by app, source, and destination.  

---

## 4. Monitoring FortiGate Application Control
Effective monitoring ensures that application control policies are functioning correctly and that critical applications are not unintentionally blocked.

### Monitoring Tools
- **FortiView → Applications:** Displays real-time application usage statistics.  
- **Log & Report → Application Control:** Lists all application events, blocked attempts, and detections.  
- **FortiAnalyzer (if available):** Provides historical analysis, trends, and compliance reports.  

### CLI Commands

```bash
# Display configured Application Control profiles
show full-configuration application list

# Monitor detected applications in real time
diagnose application list

# View recent Application Control log entries
execute log display | grep appid
