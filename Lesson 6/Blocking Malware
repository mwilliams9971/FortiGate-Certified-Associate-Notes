# Lesson 06: Blocking Malware  
**Course:** FortiGate Certified Associate (FCA)  


---

## Learning Objectives
- Understand why antivirus protection is essential  
- Explain how FortiGate antivirus works to block malware  
- Configure and monitor FortiGate antivirus protection  

---

## 1. Why Use Antivirus Protection
Malware remains one of the most common and damaging forms of cyber threats. Without proper inspection, it can infiltrate networks through emails, downloads, or web traffic.

Malware can:
- Cause data breaches  
- Extort money (ransomware)  
- Steal intellectual property  
- Disrupt business operations  

FortiGate’s antivirus engine inspects traffic in real time to detect and block malicious files before they reach end users or internal systems.

---

## 2. How FortiGate Antivirus Works
FortiGate uses a combination of **signature-based detection**, **heuristics**, and **machine learning** to identify and stop malware across multiple protocols (HTTP, SMTP, POP3, IMAP, FTP, etc.).  

### Core Components
- **FortiGuard Antivirus Database**  
  - Maintained by FortiGuard Labs and continuously updated with the latest malware signatures.  
  - Updates can be scheduled or automatically synchronized to ensure current protection against new and evolving threats.  

### Detection Techniques
1. **Antivirus Scan**  
   - Detects known malware using pattern and hash-based signatures.  
   - Fastest and simplest detection method.  
   - Identifies exact matches found in the FortiGuard database.  

2. **Grayware Scan**  
   - Detects unwanted applications (grayware) that are not classified as viruses but may cause undesirable behavior or performance issues.  
   - Uses FortiGuard’s grayware signature database.  

3. **Machine Learning / AI Scan**  
   - Uses predictive models to detect **zero-day threats** that do not yet have known signatures.  
   - Provides early detection of emerging malware variants based on probability and behavioral characteristics.  
   - May produce false positives, so tuning and verification are important.  

---

## 3. Configuring FortiGate Antivirus
FortiGate’s antivirus configuration is managed through **Antivirus Profiles** that define how infected or suspicious files are handled.

### Antivirus Profile Options
Within an antivirus profile, administrators can configure actions and scanning options, including:

- **Block or Monitor** infected files.  
- **Scan Email Attachments** and treat suspicious Windows executables as viruses.  
- **Send Files to FortiSandbox** for advanced analysis.  
  - FortiSandbox is an isolated testing environment that executes and observes files to determine if they exhibit malicious behavior.  
- **Enable Mobile Malware Protection** to scan Android and iOS app traffic.  
- **Quarantine Infected Files** to prevent further spread or re-access.  
- **Virus Outbreak Protection**  
  - Uses the **FortiGuard Outbreak Prevention Database**, which contains third-party malware hash signatures curated by FortiGuard Labs.  
- **External Malware Block Lists**  
  - Integrates external hash or URL lists for additional protection sources.  

---

### Configuration Steps
1. **Create an Antivirus Profile**  
   - Navigate to *Security Profiles > AntiVirus* and create a new profile.  
   - Define actions for infected, suspicious, and compressed files.  

2. **Apply the Profile to a Firewall Policy**  
   - Edit or create a policy matching the desired traffic (e.g., outgoing HTTP/HTTPS).  
   - Enable **Antivirus** under *Security Profiles* and select the profile you created.  

3. **Verify Configuration**  
   - Test detection using a harmless test file such as the EICAR test file.  
   - Confirm the file is blocked or quarantined as configured.  

4. **Monitor Antivirus Protection**  
   - Use *Log & Report > AntiVirus Events* to view detection logs.  
   - Use *FortiView > Threats* to analyze detected malware and affected endpoints.  

---

## 4. CLI and Monitoring Commands

```bash
# Display current antivirus profiles
show full-configuration antivirus profile

# View real-time antivirus events
diagnose log filter category virus
diagnose log read

# Check FortiGuard update status
get system fortiguard-service status
